<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JBoss EAP CLI :: Red Hat JBoss EAP Administration I</title>
    <link rel="prev" href="eap-web-console.html">
    <link rel="next" href="deploy.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img
          src="../../../_/img/redhat-logo.png"
          height="40px"
          alt="Red Hat"
        /></a>
      <a
        class="navbar-item"
        style="font-size: 24px; color: white"
        href="../../.."
      >Red Hat JBoss EAP Administration I</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a
          class="navbar-item"
          href="https://github.com/RedHatQuickCourses/eap-admin1/issues"
          target="_blank"
        >Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="eap-admin1" data-version="8">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Red Hat JBoss EAP Administration I</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install/index.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install/install.html">install.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install/admin.html">Managing JBoss EAP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install/extensions.html">Interpreting Extensions, Subsystems, and Profiles</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eap-config.html">JBoss EAP Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eap-web-console.html">JBoss EAP Web Console</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="eap-cli.html">JBoss EAP CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="deploy.html">Deploying Applications</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../subsystems/index.html">Subsystems</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../subsystems/database.html">Configuring Datasources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../subsystems/logging.html">Configuring Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../subsystems/messaging.html">Configuring Messaging (JMS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../subsystems/web.html">Configuring the Web Subsystem</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Red Hat JBoss EAP Administration I</span>
    <span class="version">8</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Red Hat JBoss EAP Administration I</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">8</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Red Hat JBoss EAP Administration I</a></li>
    <li><a href="index.html">Configuration</a></li>
    <li><a href="eap-cli.html">JBoss EAP CLI</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">JBoss EAP CLI</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Connect to an instance of JBoss EAP standalone with the management CLI and execute general commands.</p>
</div>
<div class="paragraph">
<p>Management Command-line Interface (CLI) Tool Overview
In Red Hat JBoss Enterprise Application Platform (JBoss EAP) the configuration values reside in XML files. There are three different options for configuring for JBoss EAP servers:</p>
</div>
<div class="paragraph">
<p>Management console
A web application that modifies the underlying XML configuration files.</p>
</div>
<div class="paragraph">
<p>Management command-line interface (CLI)
A command-line tool to manage and configure JBoss EAP instances remotely from the operating system terminal, including writing scripts for repetitive tasks.</p>
</div>
<div class="paragraph">
<p>XML
The action of manually editing XML configuration files. Red Hat does not recommend manually editing configuration files.</p>
</div>
<div class="paragraph">
<p>Some of the benefits of using the management CLI include:</p>
</div>
<div class="paragraph">
<p>Managing servers without the need of a GUI.</p>
</div>
<div class="paragraph">
<p>Writing commands in a separate file and execute them as a batch. This capability enables you to write scripts for common tasks.</p>
</div>
<div class="paragraph">
<p>The management console has limitations, but the management CLI configures almost every aspect of the XML configuration files.</p>
</div>
<div class="paragraph">
<p>Admin-Only Mode of Management CLI
JBoss EAP 7 embeds a JBoss EAP server instance inside the management CLI process. By using the embedded JBoss EAP 7 server, you can access the management CLI remote administration without connecting to a running server.</p>
</div>
<div class="paragraph">
<p>The main goal of using this approach is to enable the local administration of JBoss EAP without requiring a socket-based connection. This can be very useful when, for example, for security reasons, the 9990 management port is not available.</p>
</div>
<div class="paragraph">
<p>Another example of how this is useful is that you can perform some configuration offline and apply in production only when the update can be made.</p>
</div>
<div class="paragraph">
<p>To use this feature, it is necessary to start the management CLI without providing the connection parameter:</p>
</div>
</div>
</div>
<h1 id="_jboss_homebinjboss_cli_sh" class="sect0"><a class="anchor" href="#_jboss_homebinjboss_cli_sh"></a>$JBOSS_HOME/bin/jboss-cli.sh</h1>
<div class="paragraph">
<p>Then, you can start the embedded server:</p>
</div>
<div class="paragraph">
<p>[disconnected /] embed-server --server-config=standalone-ha.xml
In the previous example, every change made by the management CLI persists on the standalone-ha.xml file, which is available in the JBOSS_HOME/standalone/configuration directory. If you do not specify the --server-config parameter, then the standalone.xml contains the changes.</p>
</div>
<div class="paragraph">
<p>It is possible to start with an empty configuration using the parameter --empty-config</p>
</div>
<div class="paragraph">
<p>[disconnected /] embed-server --server-config=production-ha.xml --empty-config
The production-ha.xml file is created in the JBOSS_HOME/standalone/configuration directory. This file only contains the XML tags related to configurations performed in the management CLI. If the file already exists, then the command fails. This condition prevents the accidental deletion of the configuration file.</p>
</div>
<div class="paragraph">
<p>NOTE
If the --empty-config parameter is not specified, then the file specified in the --server-config parameter must exist on the JBOSS_HOME/standalone/configuration directory.</p>
</div>
<div class="paragraph">
<p>Executing Commands
The management CLI is started by running the jboss-cli.sh script, which is in the bin directory of the JBoss EAP installation. This script does not require any arguments and if arguments are not provided, then it runs in disconnected mode:</p>
</div>
<h1 id="_jboss_homebinjboss_cli_sh_2" class="sect0"><a class="anchor" href="#_jboss_homebinjboss_cli_sh_2"></a>$JBOSS_HOME/bin/jboss-cli.sh</h1>
<div class="paragraph">
<p>The connect command is responsible for connecting to the server. If no argument is provided, then the command tries to connect to the default host,localhost, using the default port, 9990.</p>
</div>
<div class="paragraph">
<p>[disconnected /] connect localhost:9990
To automatically connect using the jboss-cli.sh script, use the --connect argument:</p>
</div>
<h1 id="_jboss_homebinjboss_cli_sh_connect" class="sect0"><a class="anchor" href="#_jboss_homebinjboss_cli_sh_connect"></a>$JBOSS_HOME/bin/jboss-cli.sh --connect</h1>
<div class="paragraph">
<p>NOTE
The OS user that runs the management CLI must be the same as the one that started JBoss EAP. The authentication is based on creating a file to pass a one-time token. The JBoss EAP instance creates the file. If the management CLI can read the file, then it sends the token to JBoss EAP to authenticate.</p>
</div>
<div class="paragraph">
<p>If JBoss EAP and the management CLI are started by different OS users, then the management CLI cannot read the file and the local authentication fails. Then, authentication falls back, and the management CLI requests for a username and a password.</p>
</div>
<div class="paragraph">
<p>You can use a shortcut to connect to a server:</p>
</div>
<h1 id="_jboss_homebinjboss_cli_sh_c" class="sect0"><a class="anchor" href="#_jboss_homebinjboss_cli_sh_c"></a>$JBOSS_HOME/bin/jboss-cli.sh -c</h1>
<div class="paragraph">
<p>To connect to a different host machine, use the --controller argument:</p>
</div>
<h1 id="_jboss_homebinjboss_cli_sh_connect_controlleripport" class="sect0"><a class="anchor" href="#_jboss_homebinjboss_cli_sh_connect_controlleripport"></a>$JBOSS_HOME/bin/jboss-cli.sh --connect --controller=ip:port</h1>
<div class="paragraph">
<p>NOTE
By default, the management CLI does not request credentials if it is running in the same host that started the server. The credentials can be passed with the --user and --password arguments.</p>
</div>
<div class="paragraph">
<p>Operations
Operations are a low level way to manage the JBoss EAP server.</p>
</div>
<div class="paragraph">
<p>An operation in the management CLI has the following format:</p>
</div>
<div class="paragraph">
<p>The node represents the target resource address or the node where the operation is invoked. It is a key/value pair with the node type and the node name. An example of a node is /subsystem=datasources.</p>
</div>
<div class="paragraph">
<p>After specifying the desired node, you must define the operation name with an optional list of parameters. The colon is required before the operation name because it serves as a separator between the node and the operation. A colon is required even if the node is empty. In this case, the operation is executed in the current node level.</p>
</div>
<div class="paragraph">
<p>The following operations are very common:</p>
</div>
<div class="paragraph">
<p>:read-resource
Reads a model resource attribute value.</p>
</div>
<div class="paragraph">
<p>:read-operation-names
Gets the names of all the operations for the given resource.</p>
</div>
<div class="paragraph">
<p>:read-operation-description
Gets the description of given operation.</p>
</div>
<div class="paragraph">
<p>:reload
Reloads the server by shutting down all its services and starting them again. The java process is not restarted.</p>
</div>
<div class="paragraph">
<p>:read-attribute
Gets the value of an attribute for the selected resource.</p>
</div>
<div class="paragraph">
<p>:write-attribute
Sets the value of an attribute for the selected resource.</p>
</div>
<div class="paragraph">
<p>:remove
Removes the node.</p>
</div>
<div class="paragraph">
<p>Commands
The commands contains a user friendly syntax and translate into operation requests.</p>
</div>
<div class="paragraph">
<p>The following commands are the basic supported commands for the management CLI:</p>
</div>
<div class="paragraph">
<p>cn or cd: Change the current node path to the argument.</p>
</div>
<div class="paragraph">
<p>connect: Connect to the server or domain controller.</p>
</div>
<div class="paragraph">
<p>data-source: Used to manage resources of the /subsystem=datasources/data-source type .</p>
</div>
<div class="paragraph">
<p>deploy: Deploy an application.</p>
</div>
<div class="paragraph">
<p>help: Display the help page.</p>
</div>
<div class="paragraph">
<p>history: Print, disable, enable, or clear the history expansion.</p>
</div>
<div class="paragraph">
<p>ls: list the contents of the node path.</p>
</div>
<div class="paragraph">
<p>pwn or pwd: Prints the current working node.</p>
</div>
<div class="paragraph">
<p>exit or quit: Quit the management CLI.</p>
</div>
<div class="paragraph">
<p>undeploy: Undeploy an application.</p>
</div>
<div class="paragraph">
<p>version: Prints the version and environment information.</p>
</div>
<div class="paragraph">
<p>Tab Completion
Tab completion shows all possible commands available at any point in a current command. For example, enter /. Then, press Tab to view all possible values after the / character.</p>
</div>
<div class="paragraph">
<p>[standalone@localhost:9990 /] /
core-service          deployment-overlay    interface             socket-binding-group  system-property
deployment            extension             path                  subsystem
Start typing interface after the / character, and press Tab. The management CLI not only completes the interface sub-level, but it adds an equals sign, because an equals sign is the only possible value after /interface.</p>
</div>
<div class="paragraph">
<p>Press Tab again and all the interfaces display:</p>
</div>
<div class="paragraph">
<p>[standalone@localhost:9990 /] /interface=
management  public
Running a Management CLI Script File
JBoss EAP supports using a text file for the management CLI as a script. Using this approach, you can create scripts for repetitive tasks. For example, you can create a script file that configures a data source and test a connection from the pool:</p>
</div>
<div class="paragraph">
<p>/subsystem=datasources/data-source=appDs:add\
(jndi-name=java:jboss/datasources/appDS,driver-name=h2,user-name=jb248, \
password=jb248,connection-url="jdbc:h2:mem:app;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE")
/subsystem=datasources/data-source=appDs:test-connection-in-pool
You can execute the previous content from a /home/student/create-datasource.cli text file:</p>
</div>
<h1 id="_jboss_homejboss_cli_sh_connect_controllerlocalhost9990" class="sect0"><a class="anchor" href="#_jboss_homejboss_cli_sh_connect_controllerlocalhost9990"></a>$JBOSS_HOME/jboss-cli.sh --connect --controller=localhost:9990 \</h1>
<div class="paragraph">
<p>--file=/home/student/create-datasource.cli
The management CLI provides a batch command that supports multiple commands in one atomic unit. If one of the commands or operations fails, then all the other successfully commands and operations in the batch are rolled back.</p>
</div>
<div class="paragraph">
<p>In the previous example, it as good idea to create the data source using the batch command. If testing a connection from the pool fails, then the data source creation is rolled back. To execute a batch, use the run-batch command:</p>
</div>
<div class="paragraph">
<p>batch
/subsystem=datasources/data-source=appDs:add\
(jndi-name=java:jboss/datasources/appDS,driver-name=h2,user-name=jb248,\
password=jb248,connection-url="jdbc:h2:mem:app;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE")
/subsystem=datasources/data-source=appDs:test-connection-in-pool
run-batch
Running a Command from an External Script
The management CLI enables integration with external scripts. You can pass a command or an operation to the CLI by using the --command attribute:</p>
</div>
<h1 id="_jboss_homejboss_cli_sh_c_controllerlocalhost9990" class="sect0"><a class="anchor" href="#_jboss_homejboss_cli_sh_c_controllerlocalhost9990"></a>$JBOSS_HOME/jboss-cli.sh -c --controller=localhost:9990 \</h1>
<div class="paragraph">
<p>--command="/subsystem=datasources:read-resource"
The result of the operation returns, in DMR syntax, to the script that invoked the CLI. You can specify a set of commands by using the commands attribute. This attribute specifies a comma-separated list (the list must not contain whitespace) of commands and operations that should be executed in the management CLI session.</p>
</div>
<h1 id="_jboss_cli_sh_c_controllerlocalhost9990_commandscd_subsystemdatasourcesls" class="sect0"><a class="anchor" href="#_jboss_cli_sh_c_controllerlocalhost9990_commandscd_subsystemdatasourcesls"></a>./jboss-cli.sh -c --controller=localhost:9990 --commands="cd /subsystem=datasources,ls"</h1>
<div class="sect1">
<h2 id="_section_header"><a class="anchor" href="#_section_header"></a>Section Header</h2>
<div class="sectionbody">
<div class="paragraph">
<p>lorem ipsem&#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section may not possibly have any hands-on&#8230;&#8203;.investigate what we can do here&#8230;&#8203;.</p>
</div>
<div class="paragraph">
<p>Brief overview of the EAP CLI and it&#8217;s config languages</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lots of commonly used command examples go here&#8230;&#8203;.but remember we have dedicated chapter for specific subsystems - DB, web, JMS etc</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jboss_eap_cli"><a class="anchor" href="#_jboss_eap_cli"></a>JBoss EAP CLI</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_references_2"><a class="anchor" href="#_references_2"></a>References</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_lab_accessing_the_jboss_eap_cli"><a class="anchor" href="#_lab_accessing_the_jboss_eap_cli"></a>Lab: Accessing the JBoss EAP CLI</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Log in to EAP CLI - different ways</p>
</li>
<li>
<p>Start and Stop from CLI</p>
</li>
<li>
<p>Common commands</p>
</li>
<li>
<p>Access and list values in different subsystems</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="eap-web-console.html">JBoss EAP Web Console</a></span>
  <span class="next"><a href="deploy.html">Deploying Applications</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
