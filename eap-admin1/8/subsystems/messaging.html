<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuring Messaging (JMS) :: Red Hat JBoss EAP Administration I</title>
    <link rel="prev" href="logging.html">
    <link rel="next" href="web.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img
          src="../../../_/img/redhat-logo.png"
          height="40px"
          alt="Red Hat"
        /></a>
      <a
        class="navbar-item"
        style="font-size: 24px; color: white"
        href="../../.."
      >Red Hat JBoss EAP Administration I</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a
          class="navbar-item"
          href="https://github.com/RedHatQuickCourses/eap-admin1/issues"
          target="_blank"
        >Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="eap-admin1" data-version="8">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Red Hat JBoss EAP Administration I</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install/index.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install/install.html">install.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install/admin.html">Managing JBoss EAP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install/extensions.html">Interpreting Extensions, Subsystems, and Profiles</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../config/index.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/eap-config.html">JBoss EAP 8 Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/eap-web-console.html">JBoss EAP Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/eap-cli.html">JBoss EAP CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/deploy.html">Deploying Applications to a Standalone Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Subsystems</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="database.html">Exploring the Data Source Subsystem</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="logging.html">Configuring Logging</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="messaging.html">Configuring Messaging (JMS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="web.html">Configuring the Web Subsystem</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Red Hat JBoss EAP Administration I</span>
    <span class="version">8</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Red Hat JBoss EAP Administration I</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">8</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Red Hat JBoss EAP Administration I</a></li>
    <li><a href="index.html">Subsystems</a></li>
    <li><a href="messaging.html">Configuring Messaging (JMS)</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Configuring Messaging (JMS)</h1>
<div class="sect1">
<h2 id="_messaging_concepts"><a class="anchor" href="#_messaging_concepts"></a>Messaging Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Messaging provides a loosely-coupled communication mechanism for software components, enabling asynchronous processing.</p>
</li>
<li>
<p>For example, consider the checkout process for a web store that triggers the following actions:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Authorization and payment confirmation</p>
</li>
<li>
<p>Addition and removal of inventory</p>
</li>
<li>
<p>Delivery scheduling</p>
</li>
</ol>
</div>
</li>
<li>
<p>These actions take time to process, so executing within a checkout request means users might have a long wait for order confirmation.</p>
</li>
<li>
<p>Hence they can be performed asynchronously.</p>
</li>
<li>
<p><strong>Message-Oriented Middleware (MOM)</strong> manages message delivery and provides features like security and transactions.</p>
</li>
<li>
<p>The <strong>Java Message Service (JMS)</strong> provides a standardized API for MOM access, including ConnectionFactories, Queues, and Topics.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview_of_the_java_messaging_service_jms"><a class="anchor" href="#_overview_of_the_java_messaging_service_jms"></a>Overview of the Java Messaging Service (JMS):</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>JMS is a specification enabling Java components to exchange messages independently.</p>
</li>
<li>
<p>It offers a standardized API akin to JDBC for database access, reducing dependency on product nuances.</p>
</li>
<li>
<p>JMS includes:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Connection Factories</strong>: Facilitate MOM connections.</p>
</li>
<li>
<p><strong>Queues</strong>: Support FIFO message retrieval, ideal for point-to-point communication.</p>
</li>
<li>
<p><strong>Topics</strong>: Enable publish-subscribe communication, accommodating multiple subscribers; MOM retains messages for offline consumers.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Both queues and topics are referred to as destinations, accessible via JNDI names for seamless message redirection without altering application code.</p>
</li>
<li>
<p>JMS ConnectionFactories, referenced through JNDI names, enable dynamic MOM configuration for various environments, ensuring adaptability from development to production.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_jms_message_structure"><a class="anchor" href="#_jms_message_structure"></a>JMS Message Structure</h3>
<div class="ulist">
<ul>
<li>
<p>JMS messages comprise:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Headers</strong>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Managed by the MOM, these define message attributes, primarily handled internally.</p>
</li>
<li>
<p>Typically, application logic shouldn&#8217;t rely heavily on these headers.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Properties</strong>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Producer-defined metadata facilitating communication between the MOM and consumers.</p>
</li>
<li>
<p>For instance, properties can direct messages to specific consumers, useful for scenarios like routing orders to different payment processing systems.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Bodies</strong>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Contain application-specific data, distinct from MOM infrastructure handling.</p>
</li>
<li>
<p>Regular client applications handle message transformation, ensuring MOM focuses on message delivery.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jboss_eap_built_in_messaging"><a class="anchor" href="#_jboss_eap_built_in_messaging"></a>JBoss EAP Built-in Messaging</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The following are the current messaging offerings from Red Hat:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Red Hat AMQ</strong>: Broker and clients for a MOM system based on ActiveMQ, ActiveMQ Artemis, HornetQ, QPid, and other consolidated open source message components.</p>
</li>
<li>
<p><strong>Red Hat AMQ Streams</strong>: MOM system based on Apache Kafka.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_red_hat_amq"><a class="anchor" href="#_red_hat_amq"></a>Red Hat AMQ</h3>
<div class="ulist">
<ul>
<li>
<p>ActiveMQ is managed by using the management CLI and console.</p>
</li>
<li>
<p>Activating the messaging-activemq subsystem implies using either the standalone-full.xml or standalone-full-ha.xml configuration files for standalone server mode, or either the full or full-ha profiles for managed domains.</p>
</li>
<li>
<p>The subsystem contains two child objects in the default JBoss EAP 7 configuration, exemplified by the following CLI command:</p>
<div class="listingblock">
<div class="content">
<pre>[domain@127.0.0.1:9990 /] /profile=full/subsystem=messaging-activemq:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        ...output omitted...
        "jms-bridge" =&gt; undefined,
        ...output omitted...
        "server" =&gt; {"default" =&gt; undefined},
        ...output omitted...
    }
}</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_messaging_resources"><a class="anchor" href="#_configuring_messaging_resources"></a>Configuring Messaging Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_activemq_connectors_and_acceptors"><a class="anchor" href="#_activemq_connectors_and_acceptors"></a>ActiveMQ Connectors and Acceptors</h3>
<div class="ulist">
<ul>
<li>
<p>JBoss EAP 8 includes an embedded ActiveMQ Artemis, referred to as ActiveMQ.</p>
</li>
<li>
<p>JBoss EAP configures network communication using:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Acceptors</strong>: Define protocols and parameters for incoming connections from messaging clients.</p>
</li>
<li>
<p><strong>Connectors</strong>: Specify protocols and parameters for connecting to ActiveMQ servers.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>ActiveMQ uses "connector" for client-side, differing from other JBoss EAP subsystems.</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>JBoss EAP 8 serves as both server and client for ActiveMQ, with default configuration files encompassing definitions for both.</p>
</li>
<li>
<p>ActiveMQ provides two types of acceptors and connectors:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>HTTP variety</strong>: Employs the native ActiveMQ protocol via an HTTP connection, accepted by the undertow subsystem. This setup avoids the need for JBoss EAP to open extra firewall ports for remote messaging clients.</p>
</li>
<li>
<p><strong>In-vm variety</strong>: Allows messaging clients within the same JVM as the ActiveMQ server to connect without network overhead.</p>
</li>
</ol>
</div>
</li>
<li>
<p>ActiveMQ connector&#8217;s networking parameters are indirectly defined by referencing an acceptor element.</p>
</li>
<li>
<p>The connector connects to the IP address and TCP port accepted by the acceptor, aligning with ActiveMQ&#8217;s remote client discovery mechanism.</p>
</li>
<li>
<p>The following listing shows the connectors and acceptors in the default JBoss EAP configuration files:</p>
<div class="imageblock text-center">
<div class="content">
<img src="_images/new11.png" alt="new11">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <strong>&lt;http-connector&gt;</strong> element called http-connector uses the endpoint attribute to reference the <strong>&lt;http-acceptor&gt;</strong> element called <strong>http-acceptor</strong>.</p>
</li>
<li>
<p>The <strong>&lt;in-vm-connector&gt;</strong> element does not need to reference any <strong>&lt;in-vm-acceptor&gt;</strong> element because local clients do not need discovery to find the messaging server.</p>
</li>
<li>
<p>The <strong>&lt;http-acceptor&gt;</strong> element references the http-listener called default, which is defined by the undertow subsystem.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_jms_connection_factories_and_pooled_connection_factories"><a class="anchor" href="#_jms_connection_factories_and_pooled_connection_factories"></a>JMS Connection Factories and Pooled-Connection Factories</h3>
<div class="ulist">
<ul>
<li>
<p>Connection factory resources in the messaging-activemq subsystem refer to an ActiveMQ connector within the same subsystem.</p>
</li>
<li>
<p>Below is a snippet from the default JBoss EAP configuration files:</p>
<div class="imageblock text-center">
<div class="content">
<img src="_images/new12.png" alt="new12">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <strong>&lt;connection-factory&gt;</strong> element named InVmConnectionFactory references the <strong>&lt;in-vm-connector&gt;</strong> element named in-vm, facilitating applications via the Java SE style JMS API within JBoss EAP. However, it&#8217;s not intended for use by enterprise components like servlets and EJBs.</p>
</li>
<li>
<p>The <strong>&lt;connection-factory&gt;</strong> element named RemoteConnectionFactory points to the <strong>&lt;http-connector&gt;</strong> element named http-connector, catering to remote JMS clients connecting to the embedded ActiveMQ.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Each <strong>&lt;connection-factory&gt;</strong> element, bound to distinct JNDI names via the entries attribute, corresponds to a different connector.</p>
</li>
<li>
<p>For Jakarta EE applications, it&#8217;s recommended to utilize a JMS PooledConnectionFactory instead of JMS ConnectionFactory resources. This PooledConnectionFactory offers connection reuse, XA transaction integration, and JAAS security context propagation.</p>
</li>
<li>
<p>Here&#8217;s a snippet from the default JBoss EAP configuration files featuring the pooled-connection-factory resource:</p>
<div class="imageblock text-center">
<div class="content">
<img src="_images/new13.png" alt="new13">
</div>
</div>
</li>
<li>
<p>In this example, Jakarta EE applications utilize the pooled connection factory when no connection factory is declared, with the pooled connection factory referencing the in-vm connector.</p>
</li>
<li>
<p>The following CLI command creates the resource from the previous listing under the full profile for a JBoss EAP managed domain:</p>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 /] cd /profile=full/subsystem=messaging-activemq/â€‹server=default
[domain@localhost:9990 server=default] ./pooled-connection-factory=mycf:add(\
connectors=[in-vm], entries=[java:/jms/MyCF])</pre>
</div>
</div>
</li>
<li>
<p>The reason to use a pooled connection factory instead of a regular connection factory is the same as using a JDBC datasource instead of a driver manager.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_jms_destinations"><a class="anchor" href="#_jms_destinations"></a>JMS Destinations</h3>
<div class="ulist">
<ul>
<li>
<p>When employing JBoss EAP&#8217;s embedded Message-oriented Middleware (MOM), creating JMS destination resources simultaneously generates the underlying MOM objects.</p>
</li>
<li>
<p>To create a destination by using the CLI, create either a jms-queue or a jms-topic resource.</p>
</li>
<li>
<p>For example, the following command create a topic called stocks that is bound to the JNDI name <strong>java:/jms/broker/StockUpdates</strong>:</p>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 server=default] ./jms-topic=stocks:add(entries=[java:/jms/broker/StockUpdates])</pre>
</div>
</div>
</li>
<li>
<p>The previous command adds the following to the domain mode configuration files:</p>
<div class="imageblock text-center">
<div class="content">
<img src="_images/new14.png" alt="new14">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The name attribute is the name of the managed object. This name is only administrative, as it is not used by applications that use the JMS API.</p>
</li>
<li>
<p>The entries attribute provides one or more JNDI names for the resource. These are the names visible to applications.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_configuring_messaging_resources"><a class="anchor" href="#_lab_configuring_messaging_resources"></a>Lab: Configuring Messaging Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Outcome</strong>: You should be able to create a JMS connection factory and a queue, and deploy sample applications that make use of them.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download messaging subsystem with ActiveMQ Artemis using command shown below:</p>
<div class="listingblock">
<div class="content">
<pre>[vagrant@server ~]$ sudo wget -c /opt/messaging-activemq-subsystem.jar <a href="https://repo1.maven.org/maven2/org/wildfly/wildfly-messaging-activemq-subsystem/24.0.0.Final/wildfly-messaging-activemq-subsystem-24.0.0.Final.jar" class="bare">https://repo1.maven.org/maven2/org/wildfly/wildfly-messaging-activemq-subsystem/24.0.0.Final/wildfly-messaging-activemq-subsystem-24.0.0.Final.jar</a>

[vagrant@server ~]$ sudo mv /opt/wildfly-messaging-activemq-subsystem-24.0.0.Final.jar  /opt/messaging-activemq.jar</pre>
</div>
</div>
</li>
<li>
<p>Start a JBoss EAP 8 standalone server instance.</p>
<div class="listingblock">
<div class="content">
<pre>[vagrant@server ~]$ cd /opt/EAP-8.0.0/bin/
[vagrant@server bin]$ ./standalone.sh</pre>
</div>
</div>
</li>
<li>
<p>Create the connection factory and queue by using the JNDI name expected by the applications.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a new terminal and run the management CLI script.</p>
<div class="listingblock">
<div class="content">
<pre>[vagrant@server ~]$ cd /opt/EAP-8.0.0/bin
[vagrant@server bin]$ ./jboss-cli.sh -c</pre>
</div>
</div>
</li>
<li>
<p>Add the <strong>messaging subsystem</strong> module using below command:</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 /] module add --name=messaging-activemq --resources=/opt/messaging-activemq.jar</pre>
</div>
</div>
</li>
<li>
<p>Create a pooled-connection-factory that refers to the default in-vm ActiveMQ connector. Assign the JNDI name java:/jms/CustomCF to the factory.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 /] cd /subsystem=messaging-activemq/server=default

[standalone@localhost:9990 server=default] ./pooled-connection-factory=\
custom:add(connectors=[in-vm], entries=[java:/jms/CustomCF])
{"outcome" =&gt; "success"}</pre>
</div>
</div>
</li>
<li>
<p>Leave this terminal window open with the management CLI connected.</p>
</li>
<li>
<p>Create a queue called TestQueue with java:/jms/queue/TestQueue as an assigned JNDI name.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default]$ ./jms-queue=TestQueue:add\
(entries=["java:/jms/queue/TestQueue"])
{"outcome" =&gt; "success"}</pre>
</div>
</div>
</li>
<li>
<p>Observe that the new queue has not received any messages.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default] ./jms-queue=TestQueue\
:read-resource(include-runtime=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        ...output omitted...
        "message-count" =&gt; 0L,
        "messages-added" =&gt; 0L,
        ...output omitted...
    }
}</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Deploy and use the test application to produce messages.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the management CLI to deploy the mdb-client.war application.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default]$ deploy \
/opt/mdb-client.war
[standalone@localhost:9990 server=default]</pre>
</div>
</div>
</li>
<li>
<p>In a new terminal window, send an HTTP request to the server to create a new JMS message.</p>
<div class="listingblock">
<div class="content">
<pre>[vagrant@server ~]$ curl --data "count=1" --data "label=first" \
--data "message=test message body" <a href="http://localhost:8080/mdb-client/queue" class="bare">http://localhost:8080/mdb-client/queue</a>
...output omitted...</pre>
</div>
</div>
</li>
<li>
<p>In the terminal where the management CLI is connected, verify that the messages were queued by viewing the messages-added value. Additionally, the message-count indicates that there are two messages waiting in the queue.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default] ./jms-queue=TestQueue\
:read-resource(include-runtime=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        ...output omitted...
        "message-count" =&gt; 1L,
        "messages-added" =&gt; 1L,
        ...output omitted...
    }
}</pre>
</div>
</div>
</li>
<li>
<p>Inspect the headers and properties for messages published but not yet consumed.</p>
</li>
<li>
<p>Notice that the message&#8217;s Copy and Labels attributes match what came from the publisher test application.</p>
</li>
<li>
<p>The message body is not visible with the list-messages operation.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default] ./jms-queue=TestQueue:list-messages
{
    "outcome" =&gt; "success",
    "result" =&gt; [{
        ...output omitted...
        "address" =&gt; "jms.queue.TestQueue",
        ...output omitted...
        "Copy" =&gt; 1,
        "Label" =&gt; "first",
        ...output omitted...
    }]
}</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Deploy the message consumer test application and verify that it consumes the queued messages.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the management CLI to deploy the helloworld-mdb.jar application.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 bin]$ deploy \
/opt/helloworld-mdb.jar</pre>
</div>
</div>
</li>
<li>
<p>The consumer test application includes an MDB that immediately starts consuming and logging messages. In the terminal window running JBoss EAP, verify that the log entries are similar to the following:</p>
<div class="listingblock">
<div class="content">
<pre>...output omitted...
... INFO  [class ...HelloWorldQueueMDB] ... Received Message from queue: test message body
... INFO  [class ...HelloWorldQueueMDB] ... Message Properties: Copy #1 [first]
... INFO  [class ...HelloWorldQueueMDB] ... Message Body: test message body</pre>
</div>
</div>
</li>
<li>
<p>In the terminal where the management CLI is connected, verify that messages-added is still one, but message-count is back down to zero.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default] ./jms-queue=TestQueue\
:read-resource(include-runtime=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        ...output omitted...
        "message-count" =&gt; 0L,
        "messages-added" =&gt; 1L,
        ...output omitted...
    }
}</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Publish a message and verify that the running consumer immediately reads it.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the curl terminal window, send another HTTP request to the server.</p>
<div class="listingblock">
<div class="content">
<pre>[vagrant@server ~]$ curl --data "count=1" --data "label=second" \
--data "message=test message body" <a href="http://localhost:8080/mdb-client/queue" class="bare">http://localhost:8080/mdb-client/queue</a>
...output omitted...</pre>
</div>
</div>
</li>
<li>
<p>In the terminal window running JBoss EAP, verify that the log entries are similar to the following:</p>
<div class="listingblock">
<div class="content">
<pre>...output omitted...
... INFO  [class ...HelloWorldQueueMDB] ... Received Message from queue: test message body
... INFO  [class ...HelloWorldQueueMDB] ... Message Properties: Copy #1 [second]
... INFO  [class ...HelloWorldQueueMDB] ... Message Body: test message body</pre>
</div>
</div>
</li>
<li>
<p>In the management CLI terminal window, verify that messages-added incremented and that message-count is still zero.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default] ./jms-queue=TestQueue\
:read-resource(include-runtime=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        ...output omitted...
        "message-count" =&gt; 0L,
        "messages-added" =&gt; 2L,
        ...output omitted...
    }
}</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Shut down the server and close the management CLI connection.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the management CLI terminal window, stop the JBoss EAP standalone server instance.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default] /:shutdown
{
  "outcome" =&gt; "success",
  "result" =&gt; undefined
}</pre>
</div>
</div>
</li>
<li>
<p>Exit the JBoss EAP management CLI client.</p>
<div class="listingblock">
<div class="content">
<pre>[standalone@localhost:9990 server=default]$ exit</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="logging.html">Configuring Logging</a></span>
  <span class="next"><a href="web.html">Configuring the Web Subsystem</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
